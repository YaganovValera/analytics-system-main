// src/components/MetricCommentary.tsx
import type { AnalyticsResponse } from '../../types/analytics';
import './MetricCommentary.css';

interface Props {
  analytics: AnalyticsResponse['analytics'];
}

function MetricCommentary({ analytics }: Props) {
  const {
    sum_volume,
    price_change,
    price_range_percent,
    bullish_streak,
    bearish_streak,
    dominant_hour,
    max_gap_up,
    max_gap_down,
    up_ratio,
    down_ratio,
  } = analytics;

  const lines: string[] = [];

  // üîç –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
  if (price_change > 0 && up_ratio > 0.55) {
    lines.push('–ó–∞ –ø–µ—Ä–∏–æ–¥ –Ω–∞–±–ª—é–¥–∞–ª—Å—è —É—Å—Ç–æ–π—á–∏–≤—ã–π —Ä–æ—Å—Ç: —Ü–µ–Ω–∞ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å, –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Å–≤–µ—á–µ–π –±—ã–ª–∏ –±—ã—á—å–∏–º–∏. –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–∏–ª—å–Ω–æ–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª—å—Å–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ.');
  } else if (price_change < 0 && down_ratio > 0.55) {
    lines.push('–†—ã–Ω–æ–∫ –Ω–∞—Ö–æ–¥–∏–ª—Å—è –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º –ø—Ä–æ–¥–∞–≤—Ü–æ–≤: —Å–Ω–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–ª–æ—Å—å –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ–º –º–µ–¥–≤–µ–∂—å–∏—Ö —Å–≤–µ—á–µ–π.');
  } else {
    lines.push('–Ø–≤–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞ –Ω–µ –≤—ã—è–≤–ª–µ–Ω–æ ‚Äî –¥–≤–∏–∂–µ–Ω–∏–µ –±—ã–ª–æ —Å–º–µ—à–∞–Ω–Ω—ã–º, –±–µ–∑ –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è –∏–ª–∏ –ø—Ä–æ–¥–∞–≤—Ü–∞.');
  }

  // üå™ –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –∏ –¥–∏–∞–ø–∞–∑–æ–Ω
  if (price_range_percent > 1.5) {
    lines.push(`–î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω —Å–æ—Å—Ç–∞–≤–∏–ª ${price_range_percent.toFixed(2)}% ‚Äî —ç—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≤—ã—Å–æ–∫—É—é –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å. –†—ã–Ω–æ–∫ –º–æ–≥ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã –∏–ª–∏ –Ω–æ–≤–æ—Å—Ç–∏.`);
  } else {
    lines.push(`–î–∏–∞–ø–∞–∑–æ–Ω –¥–≤–∏–∂–µ–Ω–∏—è (${price_range_percent.toFixed(2)}%) –±—ã–ª –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —É–∑–∫–∏–º, —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Å–¥–µ—Ä–∂–∞–Ω–Ω–æ–º –ø–æ–≤–µ–¥–µ–Ω–∏–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.`);
  }

  // üìä –û–±—ä—ë–º
  if (sum_volume > 0) {
    lines.push(`–¢–æ—Ä–≥–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –±—ã–ª–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π. –°—É–º–º–∞—Ä–Ω—ã–π –æ–±—ä—ë–º —Å–æ—Å—Ç–∞–≤–∏–ª ${sum_volume.toFixed(0)}, —á—Ç–æ –¥–∞—ë—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.`);
  }

  // üìà –°—Ç—Ä–∏–∫–∏
  if (bullish_streak >= 5 || bearish_streak >= 5) {
    if (bullish_streak >= bearish_streak) {
      lines.push(`–ó–∞–º–µ—á–µ–Ω–∞ —Å–∏–ª—å–Ω–∞—è –≤–æ—Å—Ö–æ–¥—è—â–∞—è —Å–µ—Ä–∏—è: ${bullish_streak} —Å–≤–µ—á–µ–π –ø–æ–¥—Ä—è–¥ ‚Äî —ç—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –±—ã—á—å–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞.`);
    } else {
      lines.push(`–í—ã–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω—ã–π –Ω–∏—Å—Ö–æ–¥—è—â–∏–π —É—á–∞—Å—Ç–æ–∫: ${bearish_streak} —Å–≤–µ—á–µ–π –ø–æ–¥—Ä—è–¥ ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ –ø–∞–Ω–∏—á–µ—Å–∫–∞—è —Ñ–∞–∑–∞ –∏–ª–∏ —Ç—Ä–µ–Ω–¥ –≤–Ω–∏–∑.`);
    }
  } else {
    lines.push('–†–æ—Å—Ç –∏ –ø–∞–¥–µ–Ω–∏–µ —á–µ—Ä–µ–¥–æ–≤–∞–ª–∏—Å—å, –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö —Å–µ—Ä–∏–π –Ω–µ –Ω–∞–±–ª—é–¥–∞–ª–æ—Å—å.');
  }

  // ‚è∞ –ß–∞—Å—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  lines.push(`–ù–∞–∏–±–æ–ª—å—à–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –æ–±—ä—ë–º–∞ –ø—Ä–∏—à–ª–∞—Å—å –Ω–∞ ${dominant_hour}:00 UTC. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ —Å –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –∫—Ä—É–ø–Ω—ã—Ö —Ä—ã–Ω–∫–æ–≤.`);

  // üî∫ –ì—ç–ø—ã
  if (max_gap_up > 0.1 || max_gap_down > 0.1) {
    lines.push(`–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –∑–Ω–∞—á–∏–º—ã–µ –≥—ç–ø—ã: –≤–≤–µ—Ä—Ö –¥–æ ${max_gap_up.toFixed(2)} –∏ –≤–Ω–∏–∑ –¥–æ ${max_gap_down.toFixed(2)}. –≠—Ç–æ —á–∞—Å—Ç–æ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è —Å–∏–ª—å–Ω—ã–º–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∞–∫—Ü–∏—è–º–∏.`);
  } else {
    lines.push('–ì—ç–ø—ã –±—ã–ª–∏ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–º–∏ ‚Äî —Ä—ã–Ω–æ–∫ –¥–≤–∏–≥–∞–ª—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –±–µ–∑ —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤.');
  }

  return (
    <div className="metric-commentary-block">
      <h4>üß† –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫</h4>
      {lines.map((line, idx) => (
        <p key={idx}>{line}</p>
      ))}
    </div>
  );
}

export default MetricCommentary;